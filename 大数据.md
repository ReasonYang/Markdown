## **Test1.1**

题目一：全校2018级学生名单分析

1）使用RDD编程的方式，找到自己的那一行信息

![img](img/20210623105624.jpg) 

![img](img/20210623105626.jpg) 

![img](img/20210623105627.jpg) 

 

## **Test1.2**

2）按照学院分组，统计每个学院的学生数量，并排序

![img](img/20210623105629.jpg) 

![img](img/20210623105630.jpg) 

![image-20210624094339307](img/20210624094339.png)

 ![img](img/20210623105628.jpg)

## **Test1.3**

3）按照学院分组，再按性别分组统计每个学院的男女生占比。

![img](img/20210623105631.jpg) 

![img](img/20210623105633.jpg) 

![img](img/20210623105632.jpg) 

![img](img/20210623105637.jpg) 

![image-20210624094131162]( img/20210624094131.png)

![img](img/20210623105634.jpg) 



## **Test1.4**

4）找出学号最小值，最大值。分析及推测所有学生的学号排列规律，包括但不限于：
是否存在学号区段与专业班级的关系，是否存在学号区段与学院名称的关系，
是否存在空闲的学号区段未被使用

 ![image-20210624092559367](img/20210624092606.png)

![image-20210624093519959](img/20210624093520.png)

![image-20210624093234888](img/20210624093234.png)

![image-20210624093326936](img/20210624093327.png)

 

## **Test1.5**

5）按学生姓氏统计排名TOP5的姓氏及人数（只统计在校的非留学生，注意复姓）

![image-20210624114030586](img/20210624114030.png)

 ![image-20210624113903694](img/20210624113910.png)

![image-20210624114531465](img/20210624114531.png)

![image-20210624114147417](img/20210624114147.png) 

 ![image-20210624114304213](img/20210624114304.png)



## **Test2.1**

题目二：红楼梦所用到的汉字统计分析
1）统计小说全文用到的汉字及其出现次数，并排序得到最常用的500个汉字。

文本处理：全选文件用Notepad++ 打开，

ctrl+H替换所有打开文件，删除水印，删除回车符CRLF，删除空格，全部保存

![img](img/20210623105635.jpg) 

下载安装Notepad++插件PythonScript

https://blog.csdn.net/qing666888/article/details/78333612/

运行python脚本转换文本格式为UTF-8，删除空行

![img](img/20210623105636.jpg) 

![image-20210624115258660](img/20210624115258.png)

![image-20210630092701836](img/20210630092701.png)

![image-20210624115510387](img/20210624115510.png)



## TestNew

新增题目：物联卡流量/短信活跃度分析

1）按照EC来统计每个EC所属的卡在有流量的和没有流量的占比（有活跃的卡的占比）学号尾号123

处理数据card_info表

![image-20210630084853921](img/20210630084901.png)

![image-20210630084915416](img/20210630084915.png)

其他表ec_info，prod_sublist，flow_daily，prod_info采用同样的处理后，进行SQL查询。

通过ecid分别查询办卡、使用了流量、办理了流量套餐的人数，将其转换为视图后与ec_info表拼接，再转换为视图。

![image-20210630085927077](img/20210630085927.png)

计算有流量和无流量的占比，分母为每个公司总办卡数，分子为办理了流量且使用了流量的。结果如下

![image-20210629093418580](img/20210629093425.png)

脚本文件如下：

![image-20210630090345164](img/20210630090345.png)

![image-20210630090402998](img/20210630090403.png)

![image-20210630090438009](img/20210630090438.png)



## Test3.1+3.2

题目三：某电商平台用户行为日志统计分析

1)用户session时长的计算，找到TOP10 session 的用户ID
2)获取点击操作排名(点击量)前10的品类、并获取top10品类的点击量(有些session/用户可能会多次点击这一个品类)排名前10的user

处理数据，过滤掉无用行和中括号，映射所有字段后注册为临时表方便查询

![image-20210630110918837](img/20210630110918.png)

查询表中的session_id和对应的action_time的最大值和最小值以及计算出每个session_id的存在时间，转换成视图后排序，取前十个时长最长的session_id

![image-20210630111325356](img/20210630111325.png)

 第一小题结果如下：![image-20210630105702325](img/20210630105702.png)                

查询每个用户的点击品类和对应的session_id（排除null数据）获取前十点击量的品类，转换成视图

![image-20210630111710904](img/20210630111710.png)

第二小题第一问结果如下：

##                                                                                                                ![image-20210630105738377](img/20210630105738.png)

先求前10点击量的品类

再取前10点击量的品类中点击量前10的用户

将结果转换成视图

![image-20210630111925135](img/20210630111925.png)

第二小题第二问结果如下：

##                                                                                                                ![image-20210630105806201](img/20210630105806.png) 

脚本文件如下:

![image-20210630112216851](img/20210630112217.png)

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 